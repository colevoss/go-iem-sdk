package iem

import (
	"strings"
	"testing"
)

var data = `
station,valid,lon,lat,elevation,tmpf,tmpc,dwpf,dwpc,relh,feel,drct,sknt,sped,alti,mslp,p01m,p01i,vsby,gust,gust_mph,skyc1,skyc2,skyc3,skyl1,skyl2,skyl3,wxcodes,ice_accretion_1hr,ice_accretion_3hr,ice_accretion_6hr,peak_wind_gust,peak_wind_gust_mph,peak_wind_drct,peak_wind_time,snowdepth,metar
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
LNK,2023-10-04 00:54,-96.7633,40.8312,352.00,79.00,26.11,58.00,14.44,48.59,79.00,170.00,19.00,21.85,29.73,1005.50,0.00,0.00,10.00,27.00,31.05,FEW,SCT,M,7500.00,11000.00,M,VCTS,M,M,M,27.00,31.05,170.00,2023-10-04 00:52,M,KLNK 040054Z 17019G27KT 10SM VCTS FEW075 SCT110 26/14 A2973 RMK AO2 PK WND 17027/0052 LTG DSNT ALQDS SLP055 T02610144
`

func BenchmarkParseWeatherData(b *testing.B) {
	query := NewWeatherDataQuery()

	for i := 0; i < b.N; i++ {
		b.StopTimer()
		r := strings.NewReader(data)
		b.StartTimer()
		ParseWeatherData(r, query)
	}
}
